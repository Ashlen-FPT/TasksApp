@*@model IEnumerable<TasksApp.Models.Tasks>*@
@{
    ViewBag.Title = "Calendar";

    var events = (IEnumerable<TasksApp.Models.Tasks>)ViewData["SupervisorEvents"];
    var length = events.Count();
}


<section class="content-header">
    <h1>
        Calendar Overview
    </h1>
</section>
<br />
<table id="table" hidden>
    @for (int i = 0; i < length; i++)
    {

        <tr>
            <td>@Html.Encode(events.ElementAt(i).Status)</td>
            <td>@Html.Encode(events.ElementAt(i).DateAllTaskCompleted.Value.ToString("yyyy-MM-dd"))</td>

        </tr>
    }
</table>

<div class="calendarContainer">
    <div id="calendar"></div>
</div>


<script>
    let eventsArr = loadData();
    let calendar = initCalendar();
    function loadData() {
        let eventsArr = [];
        let todoTable = document.getElementById("table");
        let trElem = todoTable.getElementsByTagName("tr");
        console.log(trElem);
        for (let tr of trElem) {
            console.log(tr);
            let tdElems = tr.getElementsByTagName("td");
            let eventObj = {
                title: tdElems[0].innerText,
                start: tdElems[1].innerText,
                color:@Html.Raw(ViewData["Color"]),
            }
            eventsArr.push(eventObj);
        }
        return eventsArr;
    }

    function initCalendar() {
        var calendarEl = document.getElementById('calendar');
        let calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            headerToolbar: {
                left: 'dayGridMonth,dayGridWeek,dayGridDay',
                center: 'title',
                right: 'prev,next'
            },

            events: eventsArr,
        });
        calendar.render();
        return calendar;
    }
</script>